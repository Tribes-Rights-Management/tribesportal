@tailwind base;
@tailwind components;
@tailwind utilities;

/* ═══════════════════════════════════════════════════════════════════════════════
   GLOBAL SPACING SYSTEM — TRIBES STANDARD (LOCKED)

   Premium spacing tokens for Apple/Stripe/Mercury-level vertical rhythm.
   These tokens are authoritative and must be used consistently across all
   marketing pages, sections, and the footer.

   Usage:
   - Sections: Use --section-padding-* for consistent vertical rhythm
   - Gutters: Use --gutter-* for horizontal page margins
   - Internal: Use --space-* for component-level spacing
   ═══════════════════════════════════════════════════════════════════════════════ */

:root {
  /* ─────────────────────────────────────────────────────────────────────────────
     SPACING SCALE — 8px base unit, reduced ~15-20% for institutional density
     ───────────────────────────────────────────────────────────────────────────── */
  --space-0: 0px;
  --space-1: 4px;
  --space-2: 8px;
  --space-3: 12px;
  --space-4: 16px;
  --space-5: 24px;
  --space-6: 32px;
  --space-7: 48px;
  --space-8: 64px;
  --space-9: 72px;
  --space-10: 88px;
  --space-11: 120px;
  --space-12: 160px;
  
  /* Footer-specific tokens — Institutional grade, balanced zones */
  --footer-pt-mobile: 72px;    /* Locked: equal top/bottom */
  --footer-pt-tablet: 72px;
  --footer-pt-desktop: 72px;
  --footer-pb-mobile: 72px;    /* Locked: equal top/bottom */
  --footer-pb-tablet: 72px;
  --footer-pb-desktop: 72px;
  --footer-group-gap-mobile: 40px;   /* Column group spacing (mobile stack) */
  --footer-label-to-link-mobile: 16px;  /* Tight label→link */
  --footer-label-to-link-desktop: 16px;
  --footer-link-gap-mobile: 13px;    /* Link→link: 12-14px range */
  --footer-link-gap-desktop: 12px;
  --footer-column-gap-tablet: 40px;
  --footer-column-gap-desktop: 64px;
  --footer-signature-mt-mobile: 56px;  /* Zone gap: links → brand block */
  --footer-signature-mt-tablet: 56px;
  --footer-signature-mt-desktop: 56px;

  /* ─────────────────────────────────────────────────────────────────────────────
     PAGE GUTTERS — Horizontal container padding
     Mobile: 24px | Tablet: 32px | Desktop: 48px
     ───────────────────────────────────────────────────────────────────────────── */
  --gutter: var(--space-4); /* 24px mobile default */

  /* ─────────────────────────────────────────────────────────────────────────────
     SECTION PADDING — Vertical rhythm for major page sections
     Mobile: 96px | Tablet: 120px | Desktop: 160px
     ───────────────────────────────────────────────────────────────────────────── */
  --section-padding-y: var(--space-9); /* 96px mobile default */

  /* ─────────────────────────────────────────────────────────────────────────────
     SECTION HEADER RHYTHM — Eyebrow + headline pattern
     ───────────────────────────────────────────────────────────────────────────── */
  --eyebrow-top: var(--space-5);     /* 32px breathing room from section top */
  --eyebrow-bottom: var(--space-4);  /* 24px to headline */
  --headline-bottom: var(--space-6); /* 48px to content */

  /* ─────────────────────────────────────────────────────────────────────────────
     CONTENT RHYTHM — Internal spacing
     ───────────────────────────────────────────────────────────────────────────── */
  --paragraph-gap: 28px;             /* Between paragraph blocks */
  --card-gap: var(--space-6);        /* 48px between major items */
  --step-gap: 56px;                  /* Between numbered steps */
  --step-list-top: var(--space-4);   /* 24px above step list */
}

/* Tablet breakpoint (768px+) */
@media (min-width: 768px) {
  :root {
    --gutter: var(--space-5);          /* 32px */
    --section-padding-y: var(--space-10); /* 120px */
  }
}

/* Desktop breakpoint (1024px+) */
@media (min-width: 1024px) {
  :root {
    --gutter: var(--space-6);          /* 48px */
    --section-padding-y: var(--space-11); /* 160px */
  }
}

/* ═══════════════════════════════════════════════════════════════════════════════
   GLOBAL COLOR CONTRAST SYSTEM — LOCKED

   This color system is authoritative and must not drift.
   All text must pass WCAG AA contrast minimums.

   LIGHT MODE (default):
   - Primary text: foreground (HSL 0 0% 9%) — near-black
   - Secondary text: muted-foreground (HSL 0 0% 45%) — readable gray
   - Background: background (HSL 0 0% 100%) — white

   DARK SECTIONS (#111214):
   - Primary text: white/92 — Headlines, critical copy
   - Secondary text: white/70-72 — Descriptions, body copy
   - Tertiary text: white/55-65 — Labels, meta, supporting copy
   - Meta/Footer text: white/50-60 — Copyright, legal links
   - Links: white/60 default → white/80 hover
   - Dividers: white/15

   PROHIBITIONS:
   - No text below white/50 on dark backgrounds
   - No arbitrary gray values — use semantic tokens
   - No opacity-based text that reduces readability
   ═══════════════════════════════════════════════════════════════════════════════ */

/* Apple-grade Design System
   System typography, spacing-led layout, minimal dividers, calm hierarchy */

@layer base {
  :root {
    /* Header height for content clearance calculations */
    --header-height: 64px;
    /* Mobile-aware header height variable used by hero sections */
    --header-h: 56px; /* Mobile: 56px (h-14) */

    /* ─────────────────────────────────────────────────────────────────────────────
       PREMIUM THEME TOKENS (Auth + Global)
       Used by AuthLayout and global surfaces for consistent theming
       ───────────────────────────────────────────────────────────────────────────── */
    --bg: #f5f5f5;
    --surface: #ffffff;
    --surface-2: #fbfbfb;
    --border: rgba(0,0,0,0.10);
    --text: rgba(0,0,0,0.92);
    --muted: rgba(0,0,0,0.62);
    --muted-2: rgba(0,0,0,0.46);
    --shadow: 0 8px 24px rgba(0,0,0,0.08);
    --ring: rgba(0,0,0,0.20);

    /* ─────────────────────────────────────────────────────────────────────────────
       APPLE-GRADE DESIGN TOKENS
       Light: #F5F5F7 page bg, #FFFFFF cards, #1D1D1F text, #6E6E73 secondary
       ───────────────────────────────────────────────────────────────────────────── */
    
    /* Background & Surface - Apple #F5F5F7 for page, white for cards */
    --background: 0 0% 100%;
    /* Foreground: #1D1D1F = hsl(0 0% 12%) */
    --foreground: 0 0% 12%;

    --card: 0 0% 100%;
    --card-foreground: 0 0% 12%;

    --popover: 0 0% 100%;
    --popover-foreground: 0 0% 12%;

    /* Primary - Near black #1D1D1F */
    --primary: 0 0% 12%;
    --primary-foreground: 0 0% 100%;

    /* Secondary - Soft gray */
    --secondary: 240 5% 96%;
    --secondary-foreground: 0 0% 12%;

    /* Muted: #6E6E73 secondary text (HSL tokens for Tailwind) */
    --muted: 240 5% 96%;
    --muted-foreground: 240 1% 44%;

    /* Accent */
    --accent: 240 5% 96%;
    --accent-foreground: 0 0% 12%;

    /* Destructive */
    --destructive: 0 72% 51%;
    --destructive-foreground: 0 0% 100%;

    /* Borders: #D2D2D7 (HSL for Tailwind) */
    --border-hsl: 240 2% 83%;
    /* Input border */
    --input-border: 240 2% 78%;
    --input: 240 2% 83%;
    --ring-hsl: 0 0% 12%;

    /* Marketing site radius scale */
    --radius: 12px;
    --radius-lg: 16px;
    --radius-input: 14px;
    --radius-button: 16px;

    /* Marketing site component heights */
    --button-height: 56px;
    --input-height: 52px;

    /* Tribes consent checkbox tokens (LOCKED) */
    --tribes-checkbox-border: 0 0% 81%;
    --tribes-checkbox-border-checked: 0 0% 53%;
    --tribes-checkbox-check: 0 0% 7%;
    --tribes-checkbox-focus: 0 0% 7% / 0.25;

    /* App surface - Apple-style gray canvas #F5F5F7 */
    --app-surface: 240 5% 97%;
    
    /* Sidebar */
    --sidebar-background: 0 0% 100%;
    --sidebar-foreground: 240 1% 44%;
    --sidebar-primary: 0 0% 12%;
    --sidebar-primary-foreground: 0 0% 100%;
    --sidebar-accent: 240 5% 96%;
    --sidebar-accent-foreground: 0 0% 12%;
    --sidebar-border: 240 2% 83%;
    --sidebar-ring: 0 0% 12%;

    /* Semantic */
    --success: 142 71% 45%;
    --success-foreground: 0 0% 100%;
    --warning: 38 92% 50%;
    --warning-foreground: 0 0% 9%;
    --info: 199 89% 48%;
    --info-foreground: 0 0% 100%;
  }
}

/* ═══════════════════════════════════════════════════════════════════════════════
   GLOBAL TYPOGRAPHY SCALE — LOCKED

   This typography system is authoritative and must not drift.
   No page-specific overrides. Mercury/JPMorgan reference standard.

   H1: 32px (mobile) / 40px (desktop), Semibold, -0.015em tracking
   H2: 20px globally, Medium weight, subordinate to H1
   Body: 16px, Regular, 1.65 line-height for long-form reading
   Meta: 13px for helper text, labels

   SPACING:
   - H1 margin-bottom: 12px (tight coupling to intro)
   - H2 margin-bottom: 16px
   - Paragraph gap: 1rem (not stacked whitespace)
   ═══════════════════════════════════════════════════════════════════════════════ */
@layer base {
  * {
    @apply border-border;
  }

  /* ═══════════════════════════════════════════════════════════════════════════
     GLOBAL VIEWPORT + iOS SAFARI FIX — PREVENTS WHITE FALL-THROUGH

     CRITICAL: html/body background is DARK by default to prevent white bleed
     on iOS Safari during bounce, dynamic viewport changes, and safe-area reveal.

     Light pages explicitly paint their own white background via layout wrappers.
     ═══════════════════════════════════════════════════════════════════════════ */
  html {
    /* Light mode only - Apple-like gray background */
    background-color: #f5f5f5 !important;
    margin: 0;
    padding: 0;
    min-height: 100%;
    /* Prevent bounce */
    overscroll-behavior-y: none;
    /* Prevent text size adjustments */
    -webkit-text-size-adjust: 100%;
    text-size-adjust: 100%;
  }

  body {
    /* Light mode only - Apple-like gray background */
    background-color: #f5f5f5 !important;
    color: hsl(var(--foreground));
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
    font-family: -apple-system, BlinkMacSystemFont, 'SF Pro Text', 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
    /* Marketing site alignment: 16px base, 24px line-height */
    font-size: 16px;
    line-height: 1.5;
    letter-spacing: 0;
    margin: 0;
    padding: 0;
    /* Prevent horizontal overflow */
    overflow-x: hidden;
    /* Prevent bounce */
    overscroll-behavior-y: none;
    /* iOS Safari viewport fix - use dvh for true viewport */
    min-height: 100vh;
    min-height: 100dvh;
  }

  /* Auth routes: prevent scroll, lock to viewport */
  body.auth-no-scroll {
    overflow: hidden;
    height: 100dvh;
    height: 100vh;
  }

  /* App root element(s) - ensures full viewport coverage */
  #root,
  #__next {
    position: relative;
    z-index: 1;
    /* Light mode background */
    background: #f5f5f5;
    /* iOS Safari viewport units - cascading fallbacks */
    min-height: 100vh;
    min-height: 100dvh;
    min-height: 100svh;
    /* Safe area padding for notched devices */
    padding-bottom: env(safe-area-inset-bottom);
  }

  /* H1 — Primary page heading. Marketing site alignment: 32px, 700, -0.02em */
  h1 {
    font-size: 32px;
    font-weight: 700;
    line-height: 1.125;
    letter-spacing: -0.02em;
    scroll-margin-top: calc(var(--header-height) + 16px);
  }

  @media (min-width: 768px) {
    :root {
      /* Desktop: 64px (h-16) */
      --header-h: 64px;
    }
    
    h1 {
      font-size: 40px;
    }
  }

  /* H2 — Section titles. Marketing site alignment. */
  h2 {
    font-size: 24px;
    font-weight: 600;
    line-height: 1.25;
    letter-spacing: -0.015em;
    scroll-margin-top: calc(var(--header-height) + 16px);
  }

  /* H3-H6 — Subsection headings */
  h3 {
    font-size: 18px;
    font-weight: 600;
    line-height: 1.35;
  }

  h4, h5, h6 {
    font-size: 14px;
    font-weight: 600;
    line-height: 1.4;
  }

  /* Paragraph rhythm — use gap between siblings, not stacked margins */
  p + p {
    margin-top: 1rem;
  }
}

@layer components {
  /* Status chips - outline only, neutral */
  .status-chip {
    @apply inline-flex items-center px-2 py-0.5 rounded-md text-xs font-medium;
    @apply border border-border bg-transparent text-muted-foreground;
  }

  /* ─────────────────────────────────────────────────────────────────────────────
     SECTION PADDING — Premium vertical rhythm for marketing pages
     Uses CSS custom properties from :root for responsive values
     ───────────────────────────────────────────────────────────────────────────── */
  .section-padding {
    padding-top: var(--section-padding-y);
    padding-bottom: var(--section-padding-y);
  }

  /* Footer compact padding — original spacing for root temp page */
  .footer-padding {
    padding-top: var(--section-padding-y);
    padding-bottom: var(--space-9); /* 96px bottom on all sizes */
  }

  /* Footer premium institutional padding — standard for all marketing pages */
  .footer-padding-standard {
    padding-top: var(--footer-pt-mobile);
    padding-bottom: var(--footer-pb-mobile);
  }

  /* Footer standard internal spacing utilities */
  .footer-label-spacing {
    margin-bottom: var(--footer-label-to-link-mobile);
  }
  
  .footer-link-spacing {
    margin-top: var(--footer-link-gap-mobile);
  }
  
  .footer-signature-spacing {
    margin-top: var(--footer-signature-mt-mobile);
  }

  @media (min-width: 768px) {
    .footer-padding-standard {
      padding-top: var(--footer-pt-tablet);
      padding-bottom: var(--footer-pb-tablet);
    }
    
    .footer-label-spacing {
      margin-bottom: var(--footer-label-to-link-desktop);
    }
    
    .footer-link-spacing {
      margin-top: var(--footer-link-gap-desktop);
    }
    
    .footer-signature-spacing {
      margin-top: var(--footer-signature-mt-tablet);
    }
  }

  @media (min-width: 1024px) {
    .footer-padding-standard {
      padding-top: var(--footer-pt-desktop);
      padding-bottom: var(--footer-pb-desktop);
    }
    
    .footer-signature-spacing {
      margin-top: var(--footer-signature-mt-desktop);
    }
  }

  /* Section spacing */
  .section-gap {
    @apply mb-8; /* 32px */
  }

  .subsection-gap {
    @apply mb-6; /* 24px */
  }

  .row-gap {
    @apply mb-3; /* 12px */
  }

  /* Hairline divider */
  .divider {
    @apply h-px bg-border/50;
  }

  /* Row density */
  .row-comfortable {
    @apply py-4; /* ~16px vertical = 56px total */
  }

  .row-compact {
    @apply py-2.5; /* ~10px vertical = 44px total */
  }

  /* ═══════════════════════════════════════════════════════════════════════════
     GLOBAL INTERACTION STATE SYSTEM — LOCKED
     ═══════════════════════════════════════════════════════════════════════════ */

  /* Focus ring - visible, 1px solid, 2px offset */
  .focus-ring {
    @apply focus-visible:outline-none;
  }

  .focus-ring:focus-visible {
    outline: 1px solid hsl(0 0% 9% / 0.4);
    outline-offset: 2px;
  }

  .dark .focus-ring:focus-visible,
  [data-dark="true"] .focus-ring:focus-visible {
    outline-color: hsl(0 0% 100% / 0.4);
  }

  /* Hover state - subtle opacity shift only, institutional timing */
  .hover-subtle {
    @apply transition-opacity duration-[280ms] ease-in-out;
  }

  .hover-subtle:hover {
    opacity: 0.88;
  }

  /* Button hover - subtle brightness shift, institutional timing */
  .btn-hover {
    @apply transition-[filter,opacity] duration-[280ms] ease-in-out;
  }

  .btn-hover:hover {
    filter: brightness(0.94);
  }

  .btn-hover:active {
    opacity: 0.88;
  }

  /* Link hover - underline emphasis, institutional timing */
  .link-hover {
    @apply transition-[text-decoration-color,opacity] duration-[280ms] ease-in-out;
    text-decoration: underline;
    text-decoration-color: transparent;
    text-underline-offset: 2px;
  }

  .link-hover:hover {
    text-decoration-color: currentColor;
  }

  /* Link simple - opacity shift only (for navigation), institutional timing */
  .link-simple {
    @apply transition-opacity duration-[280ms] ease-in-out;
  }

  .link-simple:hover {
    opacity: 0.75;
  }

  /* Disabled state - opacity only, no events */
  .state-disabled {
    @apply opacity-50 pointer-events-none cursor-not-allowed;
  }

  /* Input focus - border emphasis, no ring glow, institutional timing */
  .input-focus {
    @apply transition-[border-color] duration-[280ms] ease-in-out;
  }

  .input-focus:hover:not(:disabled):not(:focus) {
    border-color: hsl(0 0% 70%);
  }

  .input-focus:focus {
    border-color: hsl(0 0% 50%);
    outline: none;
  }

  /* Label style */
  .label-muted {
    @apply text-xs font-medium text-muted-foreground;
  }
}

/* ═══════════════════════════════════════════════════════════════════════════════
   FORM PRIMITIVE HARD OVERRIDES — TRIBES INSTITUTIONAL STANDARD (LOCKED)

   Purpose: ensure NO default/consumer-grade form UI survives anywhere.
   Applies to: all forms across the site (public + auth + portal + admin).
   Excludes: non-form UI by scoping to <form> where possible.

   Non-negotiables:
   - No filled-square checkbox state
   - No pill inputs
   - No glows/shadows
   - Strong disabled contrast separation
   ═══════════════════════════════════════════════════════════════════════════════ */

@layer base {
  /* Inputs / textareas / selects — hard reset inside forms */
  :where(form) :where(
      input:not([type="checkbox"]):not([type="radio"]):not([type="range"]):not([type="file"]):not([type="color"]),
      textarea,
      select
    ) {
    -webkit-appearance: none;
    appearance: none;
    border-radius: 6px;
    border-width: 1px;
    border-style: solid;
    border-color: hsl(0 0% 82%); /* ~#d0d0d0 */
    background-color: hsl(var(--background));
    color: hsl(var(--foreground));
    font-size: 13px;
    line-height: 1.4;
    padding: 8px 10px; /* compact, institutional */
    min-height: 40px;
    box-shadow: none;
  }

  :where(form) textarea {
    min-height: 120px;
    padding-top: 12px;
    resize: none;
  }

  :where(form) :where(input, textarea)::placeholder {
    color: hsl(0 0% 55%);
  }

  :where(form) :where(input, textarea, select):disabled {
    background-color: hsl(0 0% 98%);
    border-color: hsl(0 0% 86%);
    color: hsl(0 0% 45%);
    cursor: not-allowed;
  }

  /* Focus: darker border, no glow, no layout shift */
  :where(form) :where(input, textarea, select):focus {
    outline: none;
    border-color: hsl(0 0% 7%); /* ~#111 */
  }

  /* Primary submit buttons (native) */
  :where(form) button[type="submit"],
  :where(form) button:not([type]) {
    border-radius: 6px;
    min-height: 38px;
  }

  :where(form) button[type="submit"] {
    width: 100%;
    background-color: hsl(var(--foreground));
    color: hsl(var(--background));
    font-size: 13px;
    font-weight: 500;
    box-shadow: none;
    transition: opacity 280ms ease-in-out;
  }

  :where(form) button[type="submit"]:hover {
    opacity: 0.9;
  }

  :where(form) button[type="submit"]:disabled {
    background-color: hsl(0 0% 64%);
    color: hsl(0 0% 100%);
    opacity: 1;
    cursor: not-allowed;
    pointer-events: none;
  }

  /* Radix Checkbox (role="checkbox") — FORCIBLY NO FILL WHEN CHECKED */
  button[role="checkbox"][data-state] {
    background-color: hsl(var(--background)) !important;
    border: 1px solid hsl(0 0% 82%) !important;
    border-radius: 2px !important;
    box-shadow: none !important;
  }

  button[role="checkbox"][data-state="checked"] {
    background-color: hsl(var(--background)) !important;
    border-color: hsl(0 0% 32%) !important;
    color: hsl(0 0% 7%) !important;
  }

  button[role="checkbox"][data-state][data-disabled] {
    opacity: 0.45 !important;
  }

  /* Native checkbox fallback (if any exist) — EXCLUDES TribesCheckbox */
  :where(form) input[type="checkbox"]:not([data-tribes-checkbox]) {
    -webkit-appearance: none;
    appearance: none;
    width: 18px;
    height: 18px;
    border-radius: 2px;
    border: 1px solid hsl(0 0% 82%);
    background-color: hsl(var(--background));
    display: inline-grid;
    place-content: center;
  }

  :where(form) input[type="checkbox"]:not([data-tribes-checkbox]):checked {
    border-color: hsl(0 0% 32%);
    background-color: hsl(var(--background));
  }

  :where(form) input[type="checkbox"]:not([data-tribes-checkbox]):checked::after {
    content: "";
    width: 10px;
    height: 10px;
    transform: translateY(-0.5px) rotate(45deg);
    border-right: 2px solid hsl(0 0% 7%);
    border-bottom: 2px solid hsl(0 0% 7%);
  }

  :where(form) input[type="checkbox"]:not([data-tribes-checkbox]):disabled {
    opacity: 0.45;
  }
}


/* ═══════════════════════════════════════════════════════════════════════════════
   UX HARDENING — TRIBES INSTITUTIONAL STANDARD (LOCKED)
   
   Global interaction polish: tap targets, focus states, link feedback,
   headline orphan prevention. Applied to all marketing pages.
   ═══════════════════════════════════════════════════════════════════════════════ */

/* C) TAP TARGETS — Minimum 44px touch area for mobile accessibility */
@layer base {
  /* Ensure all interactive elements have adequate tap area */
  a, button {
    min-height: 44px;
    display: inline-flex;
    align-items: center;
  }
  
  /* CRITICAL: Radix checkbox renders as button — prevent inflation */
  button[role="checkbox"] {
    min-height: unset;
    height: auto;
    align-items: flex-start;
  }
  
  /* Exception: inline text links within paragraphs */
  p a, li a, span a {
    min-height: auto;
    display: inline;
  }
  
  /* Navigation links get explicit padding for tap area */
  nav a {
    padding-top: 10px;
    padding-bottom: 10px;
  }
}

/* D) FOCUS STATES — Visible, subtle, brand-appropriate */
@layer base {
  /* Global focus-visible for all interactive elements */
  a:focus-visible,
  button:focus-visible,
  [role="button"]:focus-visible,
  input:focus-visible,
  textarea:focus-visible,
  select:focus-visible {
    outline: 1px solid hsl(0 0% 9% / 0.35);
    outline-offset: 2px;
  }
  
  /* Dark background focus states */
  [data-theme="dark"] a:focus-visible,
  [data-theme="dark"] button:focus-visible,
  [style*="background: #0B"] a:focus-visible,
  [style*="background: #0B"] button:focus-visible,
  [style*="backgroundColor"] a:focus-visible,
  footer a:focus-visible,
  footer button:focus-visible {
    outline-color: hsl(0 0% 100% / 0.35);
  }
  
  /* Remove default focus for mouse users */
  a:focus:not(:focus-visible),
  button:focus:not(:focus-visible) {
    outline: none;
  }
}

/* E) LINK FEEDBACK — Immediate interaction response */
@layer base {
  /* All links get pointer cursor */
  a {
    cursor: pointer;
  }
  
  /* Active/tap state for mobile */
  a:active,
  button:active {
    opacity: 0.85;
  }
}

/* F) HEADLINE ORPHAN PREVENTION — Controlled measure for premium line breaks */
@layer components {
  /* Marketing section headlines - prevent single-word orphans */
  .headline-measure {
    max-width: 90%;
  }
  
  @media (min-width: 768px) {
    .headline-measure {
      max-width: 640px;
    }
  }
}

/* G) FONT LOADING STABILITY — Prevent layout shift */
@layer base {
  /* System font stack with font-display swap for custom fonts if added */
  @font-face {
    font-family: 'SF Pro Text';
    src: local('SF Pro Text'), local('-apple-system'), local('BlinkMacSystemFont');
    font-display: swap;
  }
}

/* ═══════════════════════════════════════════════════════════════════════════════
   INTERNAL FORM SYSTEM — TRIBES INSTITUTIONAL STANDARD (LOCKED)

   Purpose: Compact, operational forms for authenticated portal contexts.
   Applies to: Licensing, Publishing, Admin, and all internal data entry.
   
   Design principles:
   - Forms are operational instruments, not marketing surfaces
   - Neutral, system-oriented language only
   - No reassurance or explanatory copy
   - Compact spacing for repeat professional use

   Spacing tokens:
   - Field-to-field: 12-16px (--internal-field-gap)
   - Section-to-section: 24-32px (--internal-section-gap)
   - Label-to-input: 4-6px (--internal-label-gap)
   - Button group: 16-24px above (--internal-button-gap)
   ═══════════════════════════════════════════════════════════════════════════════ */

:root {
  /* Internal form spacing tokens - tighter for institutional density */
  --internal-field-gap: 12px;      /* Reduced for compact forms */
  --internal-section-gap: 24px;    /* Tighter section gaps */
  --internal-label-gap: 4px;       /* Minimal label spacing */
  --internal-button-gap: 16px;     /* Compact button separation */
  --internal-helper-gap: 3px;      /* Tight helper text */
  
  /* Internal form max-width (aligned to app content grid) */
  --internal-form-width: 520px;
  --internal-form-width-narrow: 380px;
  --internal-form-width-wide: 680px;
}

@layer components {
  /* ═══════════════════════════════════════════════════════════════════════════
     INTERNAL FORM CONTAINER — Main wrapper for portal forms
     ═══════════════════════════════════════════════════════════════════════════ */
  .internal-form {
    max-width: var(--internal-form-width);
    width: 100%;
  }

  .internal-form-narrow {
    max-width: var(--internal-form-width-narrow);
    width: 100%;
  }

  .internal-form-wide {
    max-width: var(--internal-form-width-wide);
    width: 100%;
  }

  /* ═══════════════════════════════════════════════════════════════════════════
     INTERNAL FORM SECTION — Groups related fields with subtle header
     ═══════════════════════════════════════════════════════════════════════════ */
  .internal-form-section {
    margin-bottom: var(--internal-section-gap);
  }

  .internal-form-section:last-child {
    margin-bottom: 0;
  }

  .internal-form-section-header {
    font-size: 10px;
    font-weight: 500;
    color: hsl(var(--muted-foreground));
    text-transform: uppercase;
    letter-spacing: 0.05em;
    margin-bottom: 12px;
    padding-bottom: 5px;
    border-bottom: 1px solid hsl(var(--border));
  }

  .internal-form-section-title {
    font-size: 12px;
    font-weight: 500;
    color: hsl(var(--foreground));
    margin-bottom: 8px;
  }

  /* ═══════════════════════════════════════════════════════════════════════════
     INTERNAL FORM FIELD STACK — Compact vertical field spacing
     ═══════════════════════════════════════════════════════════════════════════ */
  .internal-form-fields {
    display: flex;
    flex-direction: column;
    gap: var(--internal-field-gap);
  }

  /* ═══════════════════════════════════════════════════════════════════════════
     INTERNAL FORM FIELD — Individual field wrapper with tight label spacing
     ═══════════════════════════════════════════════════════════════════════════ */
  .internal-form-field {
    display: flex;
    flex-direction: column;
    gap: var(--internal-label-gap);
  }

  /* Internal form label - concise, factual, always visible */
  .internal-form-label {
    font-size: 11px;
    font-weight: 500;
    color: hsl(var(--foreground));
    line-height: 1.35;
  }

  /* Internal form helper text - minimal, low-contrast, factual */
  .internal-form-helper {
    font-size: 10px;
    color: hsl(var(--muted-foreground));
    line-height: 1.4;
    margin-top: var(--internal-helper-gap);
  }

  /* Internal form error - inline, concise, specific */
  .internal-form-error {
    font-size: 10px;
    color: hsl(0 0% 35%);
    line-height: 1.4;
    margin-top: var(--internal-helper-gap);
  }

  /* ═══════════════════════════════════════════════════════════════════════════
     INTERNAL FORM ROW — Horizontal field grouping (2-3 fields)
     ═══════════════════════════════════════════════════════════════════════════ */
  .internal-form-row {
    display: grid;
    gap: 16px;
  }

  .internal-form-row-2 {
    grid-template-columns: repeat(2, 1fr);
  }

  .internal-form-row-3 {
    grid-template-columns: repeat(3, 1fr);
  }

  @media (max-width: 640px) {
    .internal-form-row-2,
    .internal-form-row-3 {
      grid-template-columns: 1fr;
    }
  }

  /* ═══════════════════════════════════════════════════════════════════════════
     INTERNAL FORM ACTIONS — Button group with proper spacing
     ═══════════════════════════════════════════════════════════════════════════ */
  .internal-form-actions {
    display: flex;
    align-items: center;
    gap: 12px;
    margin-top: var(--internal-button-gap);
    padding-top: var(--internal-button-gap);
    border-top: 1px solid hsl(var(--border));
  }

  .internal-form-actions-simple {
    display: flex;
    align-items: center;
    gap: 12px;
    margin-top: var(--internal-button-gap);
  }

  /* Primary action should be first, no explicit justification */
  .internal-form-actions-right {
    justify-content: flex-end;
  }

  /* Destructive actions pushed to end */
  .internal-form-actions-space {
    justify-content: space-between;
  }

  /* ═══════════════════════════════════════════════════════════════════════════
     INTERNAL FORM DIVIDER — Subtle section separator
     ═══════════════════════════════════════════════════════════════════════════ */
  .internal-form-divider {
    height: 1px;
    background-color: hsl(var(--border));
    margin: var(--internal-section-gap) 0;
  }

  /* ═══════════════════════════════════════════════════════════════════════════
     INTERNAL FORM INLINE ROW — Key-value or label-action pairs
     ═══════════════════════════════════════════════════════════════════════════ */
  .internal-form-inline {
    display: flex;
    align-items: center;
    justify-content: space-between;
    gap: 16px;
    min-height: 40px;
  }

  .internal-form-inline-label {
    font-size: 12px;
    font-weight: 500;
    color: hsl(var(--foreground));
  }

  .internal-form-inline-value {
    font-size: 12px;
    color: hsl(var(--muted-foreground));
  }

  /* ═══════════════════════════════════════════════════════════════════════════
     APPROVAL FORM — Extremely compact, decision-focused
     ═══════════════════════════════════════════════════════════════════════════ */
  .approval-form {
    max-width: 480px;
    display: flex;
    flex-direction: column;
    gap: 12px;
  }

  .approval-form-identity {
    display: flex;
    align-items: center;
    gap: 12px;
    padding: 12px;
    background-color: hsl(var(--muted));
    border-radius: 6px;
  }

  .approval-form-identity-avatar {
    width: 36px;
    height: 36px;
    border-radius: 50%;
    background-color: hsl(var(--background));
    display: flex;
    align-items: center;
    justify-content: center;
  }

  .approval-form-identity-details {
    display: flex;
    flex-direction: column;
    gap: 2px;
  }

  .approval-form-identity-email {
    font-size: 13px;
    font-weight: 500;
    color: hsl(var(--foreground));
  }

  .approval-form-identity-meta {
    font-size: 11px;
    color: hsl(var(--muted-foreground));
  }

  .approval-form-actions {
    display: flex;
    align-items: center;
    gap: 10px;
    margin-top: 4px;
  }
}

@layer utilities {
  /* ═══════════════════════════════════════════════════════════════════════════
     iOS SAFARI VIEWPORT UTILITIES — LOCKED
     
     These utilities ensure full viewport coverage on iOS Safari with
     dynamic viewport height support and safe-area handling.
     ═══════════════════════════════════════════════════════════════════════════ */
  
  /* Full dynamic viewport height - iOS Safari compatible */
  .min-h-dvh {
    min-height: 100vh;
    min-height: 100dvh;
  }

  /* Safe area bottom padding for notched devices */
  .pb-safe {
    padding-bottom: env(safe-area-inset-bottom);
  }

  /* Content fade - opacity only, institutional timing */
  .animate-content-fade {
    animation: contentFade 280ms ease-in-out forwards;
  }

  @keyframes contentFade {
    from { opacity: 0; }
    to { opacity: 1; }
  }

  /* Button active state - subtle feedback, institutional timing */
  .btn-active {
    @apply active:opacity-90 active:transition-opacity active:duration-[280ms] active:ease-in-out;
  }

  /* Global focus visible for dark surfaces */
  [data-surface="dark"] *:focus-visible {
    outline: 1px solid hsl(0 0% 100% / 0.4) !important;
    outline-offset: 2px;
  }

  /* ═══════════════════════════════════════════════════════════════════════════
     INSTITUTIONAL MOTION SYSTEM — LOCKED
     
     All motion uses calm, financial-grade timing:
     - Micro-interactions: 280ms
     - Standard transitions: 320ms  
     - Overlays/modals: 360-400ms
     - Easing: ease-in-out only (no bounce, no elastic, no spring)
     ═══════════════════════════════════════════════════════════════════════════ */

  /* Standard interaction - hover, focus, state changes */
  .transition-interaction {
    @apply transition-all duration-[280ms] ease-in-out;
  }

  /* Element transitions - accordions, tabs, content swaps */
  .transition-element {
    @apply transition-all duration-[320ms] ease-in-out;
  }

  /* Overlay/drawer transitions - slower, financial-grade motion */
  .transition-overlay {
    @apply transition-all duration-[360ms] ease-in-out;
  }

  /* Modal transitions - deliberate, premium feel */
  .transition-modal {
    @apply transition-all duration-[400ms] ease-in-out;
  }

  /* Opacity-only transitions for subtle state changes */
  .transition-opacity-institutional {
    @apply transition-opacity duration-[280ms] ease-in-out;
  }

  /* Transform transitions for position/scale changes */
  .transition-transform-institutional {
    @apply transition-transform duration-[320ms] ease-in-out;
  }
}
