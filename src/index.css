@tailwind base;
@tailwind components;
@tailwind utilities;

/* ═══════════════════════════════════════════════════════════════════════════════
   GLOBAL SPACING SYSTEM — TRIBES STANDARD (LOCKED)

   Premium spacing tokens for Apple/Stripe/Mercury-level vertical rhythm.
   These tokens are authoritative and must be used consistently across all
   marketing pages, sections, and the footer.

   Usage:
   - Sections: Use --section-padding-* for consistent vertical rhythm
   - Gutters: Use --gutter-* for horizontal page margins
   - Internal: Use --space-* for component-level spacing
   ═══════════════════════════════════════════════════════════════════════════════ */

:root {
  /* ─────────────────────────────────────────────────────────────────────────────
     SPACING SCALE — 8px base unit
     ───────────────────────────────────────────────────────────────────────────── */
  --space-0: 0px;
  --space-1: 8px;
  --space-2: 12px;
  --space-3: 16px;
  --space-4: 24px;
  --space-5: 32px;
  --space-6: 48px;
  --space-7: 64px;
  --space-8: 80px;
  --space-9: 96px;
  --space-10: 120px;
  --space-11: 160px;
  --space-12: 200px;
  
  /* Footer-specific tokens — Institutional grade, balanced zones */
  --footer-pt-mobile: 72px;    /* Locked: equal top/bottom */
  --footer-pt-tablet: 72px;
  --footer-pt-desktop: 72px;
  --footer-pb-mobile: 72px;    /* Locked: equal top/bottom */
  --footer-pb-tablet: 72px;
  --footer-pb-desktop: 72px;
  --footer-group-gap-mobile: 40px;   /* Column group spacing (mobile stack) */
  --footer-label-to-link-mobile: 16px;  /* Tight label→link */
  --footer-label-to-link-desktop: 16px;
  --footer-link-gap-mobile: 13px;    /* Link→link: 12-14px range */
  --footer-link-gap-desktop: 12px;
  --footer-column-gap-tablet: 40px;
  --footer-column-gap-desktop: 64px;
  --footer-signature-mt-mobile: 56px;  /* Zone gap: links → brand block */
  --footer-signature-mt-tablet: 56px;
  --footer-signature-mt-desktop: 56px;

  /* ─────────────────────────────────────────────────────────────────────────────
     PAGE GUTTERS — Horizontal container padding
     Mobile: 24px | Tablet: 32px | Desktop: 48px
     ───────────────────────────────────────────────────────────────────────────── */
  --gutter: var(--space-4); /* 24px mobile default */

  /* ─────────────────────────────────────────────────────────────────────────────
     SECTION PADDING — Vertical rhythm for major page sections
     Mobile: 96px | Tablet: 120px | Desktop: 160px
     ───────────────────────────────────────────────────────────────────────────── */
  --section-padding-y: var(--space-9); /* 96px mobile default */

  /* ─────────────────────────────────────────────────────────────────────────────
     SECTION HEADER RHYTHM — Eyebrow + headline pattern
     ───────────────────────────────────────────────────────────────────────────── */
  --eyebrow-top: var(--space-5);     /* 32px breathing room from section top */
  --eyebrow-bottom: var(--space-4);  /* 24px to headline */
  --headline-bottom: var(--space-6); /* 48px to content */

  /* ─────────────────────────────────────────────────────────────────────────────
     CONTENT RHYTHM — Internal spacing
     ───────────────────────────────────────────────────────────────────────────── */
  --paragraph-gap: 28px;             /* Between paragraph blocks */
  --card-gap: var(--space-6);        /* 48px between major items */
  --step-gap: 56px;                  /* Between numbered steps */
  --step-list-top: var(--space-4);   /* 24px above step list */
}

/* Tablet breakpoint (768px+) */
@media (min-width: 768px) {
  :root {
    --gutter: var(--space-5);          /* 32px */
    --section-padding-y: var(--space-10); /* 120px */
  }
}

/* Desktop breakpoint (1024px+) */
@media (min-width: 1024px) {
  :root {
    --gutter: var(--space-6);          /* 48px */
    --section-padding-y: var(--space-11); /* 160px */
  }
}

/* ═══════════════════════════════════════════════════════════════════════════════
   GLOBAL COLOR CONTRAST SYSTEM — LOCKED

   This color system is authoritative and must not drift.
   All text must pass WCAG AA contrast minimums.

   LIGHT MODE (default):
   - Primary text: foreground (HSL 0 0% 9%) — near-black
   - Secondary text: muted-foreground (HSL 0 0% 45%) — readable gray
   - Background: background (HSL 0 0% 100%) — white

   DARK SECTIONS (#111214):
   - Primary text: white/92 — Headlines, critical copy
   - Secondary text: white/70-72 — Descriptions, body copy
   - Tertiary text: white/55-65 — Labels, meta, supporting copy
   - Meta/Footer text: white/50-60 — Copyright, legal links
   - Links: white/60 default → white/80 hover
   - Dividers: white/15

   PROHIBITIONS:
   - No text below white/50 on dark backgrounds
   - No arbitrary gray values — use semantic tokens
   - No opacity-based text that reduces readability
   ═══════════════════════════════════════════════════════════════════════════════ */

/* Apple-grade Design System
   System typography, spacing-led layout, minimal dividers, calm hierarchy */

@layer base {
  :root {
    /* Header height for content clearance calculations */
    --header-height: 64px;
    /* Mobile-aware header height variable used by hero sections */
    --header-h: 56px; /* Mobile: 56px (h-14) */

    /* Site black (LOCKED) — used as the global baseline behind all pages */
    --site-black: 210 21% 5%;

    /* Background & Surface */
    --background: 0 0% 100%;
    --foreground: 0 0% 9%;

    --card: 0 0% 100%;
    --card-foreground: 0 0% 9%;

    --popover: 0 0% 100%;
    --popover-foreground: 0 0% 9%;

    /* Primary - Neutral dark */
    --primary: 0 0% 9%;
    --primary-foreground: 0 0% 100%;

    /* Secondary - Soft gray */
    --secondary: 0 0% 96%;
    --secondary-foreground: 0 0% 9%;

    /* Muted */
    --muted: 0 0% 96%;
    --muted-foreground: 0 0% 45%;

    /* Accent */
    --accent: 0 0% 96%;
    --accent-foreground: 0 0% 9%;

    /* Destructive */
    --destructive: 0 72% 51%;
    --destructive-foreground: 0 0% 100%;

    /* Borders & Inputs */
    --border: 0 0% 90%;
    --input: 0 0% 90%;
    --ring: 0 0% 9%;

    --radius: 10px;

    /* Tribes consent checkbox tokens (LOCKED) */
    --tribes-checkbox-border: 0 0% 81%; /* ~#cfcfcf */
    --tribes-checkbox-border-checked: 0 0% 53%; /* ~#888 */
    --tribes-checkbox-check: 0 0% 7%; /* ~#111 */
    --tribes-checkbox-focus: 0 0% 7% / 0.25;

    /* Sidebar */
    --sidebar-background: 0 0% 98%;
    --sidebar-foreground: 0 0% 45%;
    --sidebar-primary: 0 0% 9%;
    --sidebar-primary-foreground: 0 0% 100%;
    --sidebar-accent: 0 0% 94%;
    --sidebar-accent-foreground: 0 0% 9%;
    --sidebar-border: 0 0% 90%;
    --sidebar-ring: 0 0% 9%;

    /* Semantic */
    --success: 142 71% 45%;
    --success-foreground: 0 0% 100%;
    --warning: 38 92% 50%;
    --warning-foreground: 0 0% 9%;
    --info: 199 89% 48%;
    --info-foreground: 0 0% 100%;
  }

  .dark {
    /* Near-black backgrounds - #0E0F12 primary, #13141A secondary */
    --background: 228 10% 6%;
    --foreground: 220 10% 97%;

    /* Cards use secondary dark */
    --card: 228 10% 9%;
    --card-foreground: 220 10% 97%;

    --popover: 228 10% 9%;
    --popover-foreground: 220 10% 97%;

    /* Primary inverts for dark */
    --primary: 220 10% 97%;
    --primary-foreground: 228 10% 6%;

    /* Secondary surfaces */
    --secondary: 228 10% 12%;
    --secondary-foreground: 220 10% 97%;

    /* Muted - reduced opacity text */
    --muted: 228 10% 12%;
    --muted-foreground: 220 5% 60%;

    /* Accent */
    --accent: 228 10% 12%;
    --accent-foreground: 220 10% 97%;

    --destructive: 0 62% 45%;
    --destructive-foreground: 220 10% 97%;

    /* Thin dividers - rgba(255,255,255,0.08) equivalent */
    --border: 0 0% 100% / 0.08;
    --input: 228 10% 15%;
    --ring: 220 10% 80%;

    --sidebar-background: 228 10% 6%;
    --sidebar-foreground: 220 5% 60%;
    --sidebar-primary: 220 10% 97%;
    --sidebar-primary-foreground: 228 10% 6%;
    --sidebar-accent: 228 10% 12%;
    --sidebar-accent-foreground: 220 10% 97%;
    --sidebar-border: 0 0% 100% / 0.08;
    --sidebar-ring: 220 10% 80%;
  }
}

/* ═══════════════════════════════════════════════════════════════════════════════
   GLOBAL TYPOGRAPHY SCALE — LOCKED

   This typography system is authoritative and must not drift.
   No page-specific overrides. Mercury/JPMorgan reference standard.

   H1: 32px (mobile) / 40px (desktop), Semibold, -0.015em tracking
   H2: 20px globally, Medium weight, subordinate to H1
   Body: 16px, Regular, 1.65 line-height for long-form reading
   Meta: 13px for helper text, labels

   SPACING:
   - H1 margin-bottom: 12px (tight coupling to intro)
   - H2 margin-bottom: 16px
   - Paragraph gap: 1rem (not stacked whitespace)
   ═══════════════════════════════════════════════════════════════════════════════ */
@layer base {
  * {
    @apply border-border;
  }

  /* ═══════════════════════════════════════════════════════════════════════════
     GLOBAL VIEWPORT + iOS SAFARI FIX — PREVENTS WHITE FALL-THROUGH

     CRITICAL: html/body background is DARK by default to prevent white bleed
     on iOS Safari during bounce, dynamic viewport changes, and safe-area reveal.

     Light pages explicitly paint their own white background via layout wrappers.
     ═══════════════════════════════════════════════════════════════════════════ */
  html {
    /* Site black baseline - prevents iOS white flash */
    background-color: hsl(210 21% 5%) !important;
    background-color: hsl(var(--site-black)) !important;
    margin: 0;
    padding: 0;
    min-height: 100%;
    /* Prevent bounce revealing light browser canvas */
    overscroll-behavior-y: none;
  }

  body {
    /* Site black baseline for iOS Safari */
    background-color: hsl(210 21% 5%) !important;
    background-color: hsl(var(--site-black)) !important;
    color: hsl(var(--foreground));
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
    font-family: -apple-system, BlinkMacSystemFont, 'SF Pro Text', 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
    font-size: 16px;
    line-height: 1.65;
    margin: 0;
    padding: 0;
    /* Prevent horizontal overflow */
    overflow-x: hidden;
    /* Prevent bounce revealing light browser canvas */
    overscroll-behavior-y: none;
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
    /* iOS Safari viewport fix - use all three for maximum compatibility */
    min-height: 100vh;
    min-height: 100dvh;
    min-height: 100svh;
  }

  /* iOS Safari: fixed full-viewport underlay so overscroll can never reveal white */
  #ios-underlay {
    position: fixed;
    inset: 0;
    background-color: hsl(210 21% 5%);
    background-color: hsl(var(--site-black));
    z-index: 0;
    pointer-events: none;
  }

  /* App root element(s) - ensures full viewport coverage on iOS Safari */
  #root,
  #__next {
    position: relative;
    z-index: 1;
    /* Dark background as baseline - prevents white flash on overscroll */
    background: hsl(var(--site-black));
    /* iOS Safari viewport units - cascading fallbacks */
    min-height: 100vh;
    min-height: 100dvh;
    min-height: 100svh;
    /* Safe area padding for notched devices */
    padding-bottom: env(safe-area-inset-bottom);
    /* Extra insurance: extend dark color beyond viewport edges during bounce */
    box-shadow: 0 100vh 0 100vh hsl(var(--site-black)), 0 -100vh 0 100vh hsl(var(--site-black));
  }

  /* H1 — Primary page heading. Locked globally. */
  h1 {
    font-size: 32px;
    font-weight: 600;
    line-height: 1.15;
    letter-spacing: -0.015em;
    scroll-margin-top: calc(var(--header-height) + 24px);
  }

  @media (min-width: 768px) {
    :root {
      /* Desktop: 64px (h-16) */
      --header-h: 64px;
    }
    
    h1 {
      font-size: 40px;
    }
  }

  /* H2 — Section titles. Fixed size, clearly subordinate. */
  h2 {
    font-size: 20px;
    font-weight: 500;
    line-height: 1.3;
    letter-spacing: -0.01em;
    scroll-margin-top: calc(var(--header-height) + 24px);
  }

  /* H3-H6 — Subsection headings */
  h3 {
    font-size: 17px;
    font-weight: 500;
    line-height: 1.35;
  }

  h4, h5, h6 {
    font-size: 14px;
    font-weight: 500;
    line-height: 1.4;
  }

  /* Paragraph rhythm — use gap between siblings, not stacked margins */
  p + p {
    margin-top: 1rem;
  }
}

@layer components {
  /* Status chips - outline only, neutral */
  .status-chip {
    @apply inline-flex items-center px-2 py-0.5 rounded-md text-xs font-medium;
    @apply border border-border bg-transparent text-muted-foreground;
  }

  /* ─────────────────────────────────────────────────────────────────────────────
     SECTION PADDING — Premium vertical rhythm for marketing pages
     Uses CSS custom properties from :root for responsive values
     ───────────────────────────────────────────────────────────────────────────── */
  .section-padding {
    padding-top: var(--section-padding-y);
    padding-bottom: var(--section-padding-y);
  }

  /* Footer compact padding — original spacing for root temp page */
  .footer-padding {
    padding-top: var(--section-padding-y);
    padding-bottom: var(--space-9); /* 96px bottom on all sizes */
  }

  /* Footer premium institutional padding — standard for all marketing pages */
  .footer-padding-standard {
    padding-top: var(--footer-pt-mobile);
    padding-bottom: var(--footer-pb-mobile);
  }

  /* Footer standard internal spacing utilities */
  .footer-label-spacing {
    margin-bottom: var(--footer-label-to-link-mobile);
  }
  
  .footer-link-spacing {
    margin-top: var(--footer-link-gap-mobile);
  }
  
  .footer-signature-spacing {
    margin-top: var(--footer-signature-mt-mobile);
  }

  @media (min-width: 768px) {
    .footer-padding-standard {
      padding-top: var(--footer-pt-tablet);
      padding-bottom: var(--footer-pb-tablet);
    }
    
    .footer-label-spacing {
      margin-bottom: var(--footer-label-to-link-desktop);
    }
    
    .footer-link-spacing {
      margin-top: var(--footer-link-gap-desktop);
    }
    
    .footer-signature-spacing {
      margin-top: var(--footer-signature-mt-tablet);
    }
  }

  @media (min-width: 1024px) {
    .footer-padding-standard {
      padding-top: var(--footer-pt-desktop);
      padding-bottom: var(--footer-pb-desktop);
    }
    
    .footer-signature-spacing {
      margin-top: var(--footer-signature-mt-desktop);
    }
  }

  /* Section spacing */
  .section-gap {
    @apply mb-8; /* 32px */
  }

  .subsection-gap {
    @apply mb-6; /* 24px */
  }

  .row-gap {
    @apply mb-3; /* 12px */
  }

  /* Hairline divider */
  .divider {
    @apply h-px bg-border/50;
  }

  /* Row density */
  .row-comfortable {
    @apply py-4; /* ~16px vertical = 56px total */
  }

  .row-compact {
    @apply py-2.5; /* ~10px vertical = 44px total */
  }

  /* ═══════════════════════════════════════════════════════════════════════════
     GLOBAL INTERACTION STATE SYSTEM — LOCKED
     ═══════════════════════════════════════════════════════════════════════════ */

  /* Focus ring - visible, 1px solid, 2px offset */
  .focus-ring {
    @apply focus-visible:outline-none;
  }

  .focus-ring:focus-visible {
    outline: 1px solid hsl(0 0% 9% / 0.4);
    outline-offset: 2px;
  }

  .dark .focus-ring:focus-visible,
  [data-dark="true"] .focus-ring:focus-visible {
    outline-color: hsl(0 0% 100% / 0.4);
  }

  /* Hover state - subtle opacity shift only */
  .hover-subtle {
    @apply transition-opacity duration-150 ease-out;
  }

  .hover-subtle:hover {
    opacity: 0.88;
  }

  /* Button hover - subtle brightness shift */
  .btn-hover {
    @apply transition-[filter,opacity] duration-150 ease-out;
  }

  .btn-hover:hover {
    filter: brightness(0.94);
  }

  .btn-hover:active {
    opacity: 0.85;
  }

  /* Link hover - underline emphasis */
  .link-hover {
    @apply transition-[text-decoration-color,opacity] duration-150 ease-out;
    text-decoration: underline;
    text-decoration-color: transparent;
    text-underline-offset: 2px;
  }

  .link-hover:hover {
    text-decoration-color: currentColor;
  }

  /* Link simple - opacity shift only (for navigation) */
  .link-simple {
    @apply transition-opacity duration-150 ease-out;
  }

  .link-simple:hover {
    opacity: 0.75;
  }

  /* Disabled state - opacity only, no events */
  .state-disabled {
    @apply opacity-50 pointer-events-none cursor-not-allowed;
  }

  /* Input focus - border emphasis, no ring glow */
  .input-focus {
    @apply transition-[border-color] duration-150 ease-out;
  }

  .input-focus:hover:not(:disabled):not(:focus) {
    border-color: hsl(0 0% 70%);
  }

  .input-focus:focus {
    border-color: hsl(0 0% 50%);
    outline: none;
  }

  /* Label style */
  .label-muted {
    @apply text-xs font-medium text-muted-foreground;
  }
}

/* ═══════════════════════════════════════════════════════════════════════════════
   FORM PRIMITIVE HARD OVERRIDES — TRIBES INSTITUTIONAL STANDARD (LOCKED)

   Purpose: ensure NO default/consumer-grade form UI survives anywhere.
   Applies to: all forms across the site (public + auth + portal + admin).
   Excludes: non-form UI by scoping to <form> where possible.

   Non-negotiables:
   - No filled-square checkbox state
   - No pill inputs
   - No glows/shadows
   - Strong disabled contrast separation
   ═══════════════════════════════════════════════════════════════════════════════ */

@layer base {
  /* Inputs / textareas / selects — hard reset inside forms */
  :where(form) :where(
      input:not([type="checkbox"]):not([type="radio"]):not([type="range"]):not([type="file"]):not([type="color"]),
      textarea,
      select
    ) {
    -webkit-appearance: none;
    appearance: none;
    border-radius: 6px;
    border-width: 1px;
    border-style: solid;
    border-color: hsl(0 0% 82%); /* ~#d0d0d0 */
    background-color: hsl(var(--background));
    color: hsl(var(--foreground));
    font-size: 15px;
    line-height: 1.4;
    padding: 10px 12px; /* dense, contractual */
    min-height: 48px;
    box-shadow: none;
  }

  :where(form) textarea {
    min-height: 120px;
    padding-top: 12px;
    resize: none;
  }

  :where(form) :where(input, textarea)::placeholder {
    color: hsl(0 0% 55%);
  }

  :where(form) :where(input, textarea, select):disabled {
    background-color: hsl(0 0% 98%);
    border-color: hsl(0 0% 86%);
    color: hsl(0 0% 45%);
    cursor: not-allowed;
  }

  /* Focus: darker border, no glow, no layout shift */
  :where(form) :where(input, textarea, select):focus {
    outline: none;
    border-color: hsl(0 0% 7%); /* ~#111 */
  }

  /* Primary submit buttons (native) */
  :where(form) button[type="submit"],
  :where(form) button:not([type]) {
    border-radius: 6px;
    min-height: 48px;
  }

  :where(form) button[type="submit"] {
    width: 100%;
    background-color: hsl(var(--foreground));
    color: hsl(var(--background));
    font-size: 15px;
    font-weight: 500;
    box-shadow: none;
    transition: opacity 150ms ease-out;
  }

  :where(form) button[type="submit"]:hover {
    opacity: 0.9;
  }

  :where(form) button[type="submit"]:disabled {
    background-color: hsl(0 0% 64%);
    color: hsl(0 0% 100%);
    opacity: 1;
    cursor: not-allowed;
    pointer-events: none;
  }

  /* Radix Checkbox (role="checkbox") — FORCIBLY NO FILL WHEN CHECKED */
  button[role="checkbox"][data-state] {
    background-color: hsl(var(--background)) !important;
    border: 1px solid hsl(0 0% 82%) !important;
    border-radius: 2px !important;
    box-shadow: none !important;
  }

  button[role="checkbox"][data-state="checked"] {
    background-color: hsl(var(--background)) !important;
    border-color: hsl(0 0% 32%) !important;
    color: hsl(0 0% 7%) !important;
  }

  button[role="checkbox"][data-state][data-disabled] {
    opacity: 0.45 !important;
  }

  /* Native checkbox fallback (if any exist) — EXCLUDES TribesCheckbox */
  :where(form) input[type="checkbox"]:not([data-tribes-checkbox]) {
    -webkit-appearance: none;
    appearance: none;
    width: 18px;
    height: 18px;
    border-radius: 2px;
    border: 1px solid hsl(0 0% 82%);
    background-color: hsl(var(--background));
    display: inline-grid;
    place-content: center;
  }

  :where(form) input[type="checkbox"]:not([data-tribes-checkbox]):checked {
    border-color: hsl(0 0% 32%);
    background-color: hsl(var(--background));
  }

  :where(form) input[type="checkbox"]:not([data-tribes-checkbox]):checked::after {
    content: "";
    width: 10px;
    height: 10px;
    transform: translateY(-0.5px) rotate(45deg);
    border-right: 2px solid hsl(0 0% 7%);
    border-bottom: 2px solid hsl(0 0% 7%);
  }

  :where(form) input[type="checkbox"]:not([data-tribes-checkbox]):disabled {
    opacity: 0.45;
  }
}


/* ═══════════════════════════════════════════════════════════════════════════════
   UX HARDENING — TRIBES INSTITUTIONAL STANDARD (LOCKED)
   
   Global interaction polish: tap targets, focus states, link feedback,
   headline orphan prevention. Applied to all marketing pages.
   ═══════════════════════════════════════════════════════════════════════════════ */

/* C) TAP TARGETS — Minimum 44px touch area for mobile accessibility */
@layer base {
  /* Ensure all interactive elements have adequate tap area */
  a, button {
    min-height: 44px;
    display: inline-flex;
    align-items: center;
  }
  
  /* CRITICAL: Radix checkbox renders as button — prevent inflation */
  button[role="checkbox"] {
    min-height: unset;
    height: auto;
    align-items: flex-start;
  }
  
  /* Exception: inline text links within paragraphs */
  p a, li a, span a {
    min-height: auto;
    display: inline;
  }
  
  /* Navigation links get explicit padding for tap area */
  nav a {
    padding-top: 10px;
    padding-bottom: 10px;
  }
}

/* D) FOCUS STATES — Visible, subtle, brand-appropriate */
@layer base {
  /* Global focus-visible for all interactive elements */
  a:focus-visible,
  button:focus-visible,
  [role="button"]:focus-visible,
  input:focus-visible,
  textarea:focus-visible,
  select:focus-visible {
    outline: 1px solid hsl(0 0% 9% / 0.35);
    outline-offset: 2px;
  }
  
  /* Dark background focus states */
  [data-theme="dark"] a:focus-visible,
  [data-theme="dark"] button:focus-visible,
  [style*="background: #0B"] a:focus-visible,
  [style*="background: #0B"] button:focus-visible,
  [style*="backgroundColor"] a:focus-visible,
  footer a:focus-visible,
  footer button:focus-visible {
    outline-color: hsl(0 0% 100% / 0.35);
  }
  
  /* Remove default focus for mouse users */
  a:focus:not(:focus-visible),
  button:focus:not(:focus-visible) {
    outline: none;
  }
}

/* E) LINK FEEDBACK — Immediate interaction response */
@layer base {
  /* All links get pointer cursor */
  a {
    cursor: pointer;
  }
  
  /* Active/tap state for mobile */
  a:active,
  button:active {
    opacity: 0.85;
  }
}

/* F) HEADLINE ORPHAN PREVENTION — Controlled measure for premium line breaks */
@layer components {
  /* Marketing section headlines - prevent single-word orphans */
  .headline-measure {
    max-width: 90%;
  }
  
  @media (min-width: 768px) {
    .headline-measure {
      max-width: 640px;
    }
  }
}

/* G) FONT LOADING STABILITY — Prevent layout shift */
@layer base {
  /* System font stack with font-display swap for custom fonts if added */
  @font-face {
    font-family: 'SF Pro Text';
    src: local('SF Pro Text'), local('-apple-system'), local('BlinkMacSystemFont');
    font-display: swap;
  }
}

/* ═══════════════════════════════════════════════════════════════════════════════
   INTERNAL FORM SYSTEM — TRIBES INSTITUTIONAL STANDARD (LOCKED)

   Purpose: Compact, operational forms for authenticated portal contexts.
   Applies to: Licensing, Publishing, Admin, and all internal data entry.
   
   Design principles:
   - Forms are operational instruments, not marketing surfaces
   - Neutral, system-oriented language only
   - No reassurance or explanatory copy
   - Compact spacing for repeat professional use

   Spacing tokens:
   - Field-to-field: 12-16px (--internal-field-gap)
   - Section-to-section: 24-32px (--internal-section-gap)
   - Label-to-input: 4-6px (--internal-label-gap)
   - Button group: 16-24px above (--internal-button-gap)
   ═══════════════════════════════════════════════════════════════════════════════ */

:root {
  /* Internal form spacing tokens */
  --internal-field-gap: 14px;      /* 12-16px range, centered */
  --internal-section-gap: 28px;    /* 24-32px range */
  --internal-label-gap: 5px;       /* 4-6px range, centered */
  --internal-button-gap: 20px;     /* 16-24px range */
  --internal-helper-gap: 4px;      /* Helper text spacing */
  
  /* Internal form max-width (aligned to app content grid) */
  --internal-form-width: 560px;
  --internal-form-width-narrow: 400px;
  --internal-form-width-wide: 720px;
}

@layer components {
  /* ═══════════════════════════════════════════════════════════════════════════
     INTERNAL FORM CONTAINER — Main wrapper for portal forms
     ═══════════════════════════════════════════════════════════════════════════ */
  .internal-form {
    max-width: var(--internal-form-width);
    width: 100%;
  }

  .internal-form-narrow {
    max-width: var(--internal-form-width-narrow);
    width: 100%;
  }

  .internal-form-wide {
    max-width: var(--internal-form-width-wide);
    width: 100%;
  }

  /* ═══════════════════════════════════════════════════════════════════════════
     INTERNAL FORM SECTION — Groups related fields with subtle header
     ═══════════════════════════════════════════════════════════════════════════ */
  .internal-form-section {
    margin-bottom: var(--internal-section-gap);
  }

  .internal-form-section:last-child {
    margin-bottom: 0;
  }

  .internal-form-section-header {
    font-size: 13px;
    font-weight: 500;
    color: hsl(var(--muted-foreground));
    text-transform: uppercase;
    letter-spacing: 0.03em;
    margin-bottom: 16px;
    padding-bottom: 8px;
    border-bottom: 1px solid hsl(var(--border));
  }

  .internal-form-section-title {
    font-size: 15px;
    font-weight: 500;
    color: hsl(var(--foreground));
    margin-bottom: 12px;
  }

  /* ═══════════════════════════════════════════════════════════════════════════
     INTERNAL FORM FIELD STACK — Compact vertical field spacing
     ═══════════════════════════════════════════════════════════════════════════ */
  .internal-form-fields {
    display: flex;
    flex-direction: column;
    gap: var(--internal-field-gap);
  }

  /* ═══════════════════════════════════════════════════════════════════════════
     INTERNAL FORM FIELD — Individual field wrapper with tight label spacing
     ═══════════════════════════════════════════════════════════════════════════ */
  .internal-form-field {
    display: flex;
    flex-direction: column;
    gap: var(--internal-label-gap);
  }

  /* Internal form label - concise, factual, always visible */
  .internal-form-label {
    font-size: 13px;
    font-weight: 500;
    color: hsl(var(--foreground));
    line-height: 1.3;
  }

  /* Internal form helper text - minimal, low-contrast, factual */
  .internal-form-helper {
    font-size: 12px;
    color: hsl(var(--muted-foreground));
    line-height: 1.4;
    margin-top: var(--internal-helper-gap);
  }

  /* Internal form error - inline, concise, specific */
  .internal-form-error {
    font-size: 12px;
    color: hsl(0 0% 35%);
    line-height: 1.4;
    margin-top: var(--internal-helper-gap);
  }

  /* ═══════════════════════════════════════════════════════════════════════════
     INTERNAL FORM ROW — Horizontal field grouping (2-3 fields)
     ═══════════════════════════════════════════════════════════════════════════ */
  .internal-form-row {
    display: grid;
    gap: 16px;
  }

  .internal-form-row-2 {
    grid-template-columns: repeat(2, 1fr);
  }

  .internal-form-row-3 {
    grid-template-columns: repeat(3, 1fr);
  }

  @media (max-width: 640px) {
    .internal-form-row-2,
    .internal-form-row-3 {
      grid-template-columns: 1fr;
    }
  }

  /* ═══════════════════════════════════════════════════════════════════════════
     INTERNAL FORM ACTIONS — Button group with proper spacing
     ═══════════════════════════════════════════════════════════════════════════ */
  .internal-form-actions {
    display: flex;
    align-items: center;
    gap: 12px;
    margin-top: var(--internal-button-gap);
    padding-top: var(--internal-button-gap);
    border-top: 1px solid hsl(var(--border));
  }

  .internal-form-actions-simple {
    display: flex;
    align-items: center;
    gap: 12px;
    margin-top: var(--internal-button-gap);
  }

  /* Primary action should be first, no explicit justification */
  .internal-form-actions-right {
    justify-content: flex-end;
  }

  /* Destructive actions pushed to end */
  .internal-form-actions-space {
    justify-content: space-between;
  }

  /* ═══════════════════════════════════════════════════════════════════════════
     INTERNAL FORM DIVIDER — Subtle section separator
     ═══════════════════════════════════════════════════════════════════════════ */
  .internal-form-divider {
    height: 1px;
    background-color: hsl(var(--border));
    margin: var(--internal-section-gap) 0;
  }

  /* ═══════════════════════════════════════════════════════════════════════════
     INTERNAL FORM INLINE ROW — Key-value or label-action pairs
     ═══════════════════════════════════════════════════════════════════════════ */
  .internal-form-inline {
    display: flex;
    align-items: center;
    justify-content: space-between;
    gap: 16px;
    min-height: 40px;
  }

  .internal-form-inline-label {
    font-size: 13px;
    font-weight: 500;
    color: hsl(var(--foreground));
  }

  .internal-form-inline-value {
    font-size: 13px;
    color: hsl(var(--muted-foreground));
  }

  /* ═══════════════════════════════════════════════════════════════════════════
     APPROVAL FORM — Extremely compact, decision-focused
     ═══════════════════════════════════════════════════════════════════════════ */
  .approval-form {
    max-width: 480px;
    display: flex;
    flex-direction: column;
    gap: 12px;
  }

  .approval-form-identity {
    display: flex;
    align-items: center;
    gap: 12px;
    padding: 12px;
    background-color: hsl(var(--muted));
    border-radius: 6px;
  }

  .approval-form-identity-avatar {
    width: 36px;
    height: 36px;
    border-radius: 50%;
    background-color: hsl(var(--background));
    display: flex;
    align-items: center;
    justify-content: center;
  }

  .approval-form-identity-details {
    display: flex;
    flex-direction: column;
    gap: 2px;
  }

  .approval-form-identity-email {
    font-size: 14px;
    font-weight: 500;
    color: hsl(var(--foreground));
  }

  .approval-form-identity-meta {
    font-size: 12px;
    color: hsl(var(--muted-foreground));
  }

  .approval-form-actions {
    display: flex;
    align-items: center;
    gap: 10px;
    margin-top: 4px;
  }
}

@layer utilities {
  /* ═══════════════════════════════════════════════════════════════════════════
     iOS SAFARI VIEWPORT UTILITIES — LOCKED
     
     These utilities ensure full viewport coverage on iOS Safari with
     dynamic viewport height support and safe-area handling.
     ═══════════════════════════════════════════════════════════════════════════ */
  
  /* Full dynamic viewport height - iOS Safari compatible */
  .min-h-dvh {
    min-height: 100vh;
    min-height: 100dvh;
  }

  /* Safe area bottom padding for notched devices */
  .pb-safe {
    padding-bottom: env(safe-area-inset-bottom);
  }

  /* Content fade - opacity only, 150ms */
  .animate-content-fade {
    animation: contentFade 0.15s ease-out forwards;
  }

  @keyframes contentFade {
    from { opacity: 0; }
    to { opacity: 1; }
  }

  /* Button active state - brief opacity reduction, instant feedback */
  .btn-active {
    @apply active:opacity-85 active:transition-opacity active:duration-75;
  }

  /* Global focus visible for dark surfaces */
  [data-surface="dark"] *:focus-visible {
    outline: 1px solid hsl(0 0% 100% / 0.4) !important;
    outline-offset: 2px;
  }

  /* Global transition utility - locked duration */
  .transition-interaction {
    @apply transition-all duration-150 ease-out;
  }
}
